zabbix_export:
  version: '6.4'
  template_groups:
    - uuid: 8c358fe377d44a6093cbed9827d861ba
      name: Zabbix-CVE
  templates:
    - uuid: 3fdd016d50ea417aa1f4f6ade7f01f4c
      template: 'Zabbix CVE Watch'
      name: 'Zabbix CVE Watch'
      description: 'Template containing 20 Items 5 Trigger and a Dashboard to monitor the last reported CVE via the Zabbix website'
      groups:
        - name: Zabbix-CVE
      items:
        - uuid: 0d0a04c1b4ba459f82263ae9d2d091c4
          name: 'Last Critical CVE Affected Version'
          type: DEPENDENT
          key: Last-reported-Critical-CVE-Affected-Version
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  var ticketid = value.trim();
                  var apiUrl = "https://cveawg.mitre.org/api/cve/" + ticketid;
                  var result = [];
                  try {
                      Zabbix.log(4, 'Making GET request to the API');
                  
                      var req = new HttpRequest(),
                          resp;
                  
                      // Set up headers and authentication if necessary
                  
                      // Make the GET request to the API
                      resp = req.get('https://cveawg.mitre.org/api/cve/' + ticketid);
                  
                      if (req.getStatus() != 200) {
                          throw 'Response code: ' + req.getStatus();
                      }
                  
                      // Logging for the API response
                      Zabbix.log(4, 'API response: ' + resp);
                  
                      // Parse the JSON response
                      var jsonResponse = JSON.parse(resp);
                  
                      // Access the field of response and directly assign its value to result
                      var containers = jsonResponse.containers;
                  
                      if (containers && containers.cna && containers.cna.affected && containers.cna.affected.length > 0) {
                          var affectedVersions = containers.cna.affected[0].versions;
                          
                          // Find all affected versions
                          for (var i = 0; i < affectedVersions.length; i++) {
                              if (affectedVersions[i].status === "affected") {
                                  var versionRange = affectedVersions[i].version;
                                  if (affectedVersions[i].lessThanOrEqual) {
                                      versionRange += " through " + affectedVersions[i].lessThanOrEqual;
                                  }
                                  result.push(versionRange);
                              }
                          }
                      }
                  
                      // Logging for the runtime state value
                      Zabbix.log(4, 'Affected Version Ranges: ' + result.join(', '));
                  } catch (error) {
                      Zabbix.log(4, 'API request failed: ' + error);
                  }
                  
                  return result.join(', ');
                  
          master_item:
            key: Last-reported-Critical-CVE-ID-Number
          tags:
            - tag: type
              value: zabbix-cve
        - uuid: b426b9e12261497cbe2c364b87da4498
          name: 'Last Critical CVE Creation Date'
          type: HTTP_AGENT
          key: Last-reported-Critical-CVE-Creation-Date
          delay: 30m
          trends: '0'
          value_type: TEXT
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/[\s\S]*?<tbody>([\s\S]*?)<div class=''dev-status-column-view-wrapper''>[\s\S]*/, "$1");'
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/[\s\S]*?class="created"> <span title="([\s\S]*?)">[\s\S]*/, "$1");'
            - type: REGEX
              parameters:
                - '^(\d{4})\s(\w{3})\s(\d{2})\s(\d{2}):(\d{2})$'
                - \1-\2-\3
          timeout: 5s
          url: 'https://support.zabbix.com/sr/jira.issueviews:searchrequest-printable/temp/SearchRequest.html'
          query_fields:
            - name: jqlQuery
              value: 'issuetype = "Defect (Security)" AND priority = Critical ORDER BY UPDATED DESC'
            - name: tempMax
              value: '5'
          tags:
            - tag: type
              value: zabbix-cve
        - uuid: 6e44a881cdd14e03b10b2975acc2e8e5
          name: 'Last Critical CVE Description'
          type: HTTP_AGENT
          key: Last-reported-Critical-CVE-Description
          delay: 30m
          trends: '0'
          value_type: TEXT
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/[\s\S]*?<tbody>([\s\S]*?)<div class=''dev-status-column-view-wrapper''>[\s\S]*/, "$1");'
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/[\s\S]*?class="summary"><p>([\s\S]*?)<td class="assignee">[\s\S]*/, "$1");'
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/.*?>([^<]*?)<\/a>.*/g, "$1");'
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/<a.*?>([^<]*?)<\/a>|<\/p>|<\/td>/g, "$1");'
          timeout: 5s
          url: 'https://support.zabbix.com/sr/jira.issueviews:searchrequest-printable/temp/SearchRequest.html'
          query_fields:
            - name: jqlQuery
              value: 'issuetype = "Defect (Security)" AND priority = Critical ORDER BY UPDATED DESC'
            - name: tempMax
              value: '5'
          tags:
            - tag: type
              value: zabbix-cve
        - uuid: c5f7475eb25d43b2be593818dc270646
          name: 'Last Critical CVE Fixed Version'
          type: DEPENDENT
          key: Last-reported-Critical-CVE-Fixed-Version
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  var ticketid = value.trim();
                  var apiUrl = "https://cveawg.mitre.org/api/cve/" + ticketid;
                  var result = [];
                  try {
                      Zabbix.log(4, 'Making GET request to the API');
                  
                      var req = new HttpRequest(),
                          resp;
                  
                      // Make the GET request to the API
                      resp = req.get(apiUrl);
                  
                      if (req.getStatus() != 200) {
                          throw 'Response code: ' + req.getStatus();
                      }
                  
                      // Logging for the API response
                      Zabbix.log(4, 'API response: ' + resp);
                  
                      // Parse the JSON response
                      var jsonResponse = JSON.parse(resp);
                  
                      // Access the field of response and directly assign its value to result
                      var containers = jsonResponse.containers;
                  
                      if (containers && containers.cna && containers.cna.affected && containers.cna.affected.length > 0) {
                          var affectedVersions = containers.cna.affected[0].versions;
                  
                          // Find all unaffected versions
                          for (var i = 0; i < affectedVersions.length; i++) {
                              var changes = affectedVersions[i].changes;
                              for (var j = 0; j < changes.length; j++) {
                                  if (changes[j].status === "unaffected") {
                                      var versionRange = changes[j].at;
                                      result.push(versionRange);
                                  }
                              }
                          }
                      }
                  
                      // Logging for the runtime state value
                      Zabbix.log(4, 'Unaffected Version Ranges: ' + result.join(', '));
                  } catch (error) {
                      Zabbix.log(4, 'API request failed: ' + error);
                  }
                  
                  return result.join(', ');
                  
          master_item:
            key: Last-reported-Critical-CVE-ID-Number
          tags:
            - tag: type
              value: zabbix-cve
        - uuid: 30014a0e1d004143be3663b083cfd4af
          name: 'Last Critical CVE ID Number'
          type: HTTP_AGENT
          key: Last-reported-Critical-CVE-ID-Number
          delay: 30m
          trends: '0'
          value_type: TEXT
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/[\s\S]*?<tbody>([\s\S]*?)<div class=''dev-status-column-view-wrapper''>[\s\S]*/, "$1");'
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/[\s\S]*?(CVE-\d{4}-\d+)[\s\S]*/, "$1");'
          timeout: 5s
          url: 'https://support.zabbix.com/sr/jira.issueviews:searchrequest-printable/temp/SearchRequest.html'
          query_fields:
            - name: jqlQuery
              value: 'issuetype = "Defect (Security)" AND priority = Critical ORDER BY UPDATED DESC'
            - name: tempMax
              value: '5'
          tags:
            - tag: type
              value: zabbix-cve
        - uuid: a2b8012fb59a48298c6924ad095a6014
          name: 'Last Critical CVE Resolution'
          type: HTTP_AGENT
          key: Last-reported-Critical-CVE-Resolution
          delay: 30m
          trends: '0'
          value_type: TEXT
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/[\s\S]*?<tbody>([\s\S]*?)<div class=''dev-status-column-view-wrapper''>[\s\S]*/, "$1");'
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/[\s\S]*<td class="resolution">\s*([\s\S]*?)\s*<\/td>[\s\S]*/, "$1");'
          timeout: 5s
          url: 'https://support.zabbix.com/sr/jira.issueviews:searchrequest-printable/temp/SearchRequest.html'
          query_fields:
            - name: jqlQuery
              value: 'issuetype = "Defect (Security)" AND priority = Critical ORDER BY UPDATED DESC'
            - name: tempMax
              value: '5'
          tags:
            - tag: type
              value: zabbix-cve
        - uuid: 3da10a5278b740bfb68acd54a185ec5c
          name: 'Last Critical CVE Status'
          type: HTTP_AGENT
          key: Last-reported-Critical-CVE-Status
          delay: 30m
          trends: '0'
          value_type: TEXT
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/[\s\S]*?<tbody>([\s\S]*?)<div class=''dev-status-column-view-wrapper''>[\s\S]*/, "$1");'
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/[\s\S]*<td class="status">\s*<span[^>]*>([\s\S]*?)<\/span>[\s\S]*/, "$1");'
          timeout: 5s
          url: 'https://support.zabbix.com/sr/jira.issueviews:searchrequest-printable/temp/SearchRequest.html'
          query_fields:
            - name: jqlQuery
              value: 'issuetype = "Defect (Security)" AND priority = Critical ORDER BY UPDATED DESC'
            - name: tempMax
              value: '5'
          tags:
            - tag: type
              value: zabbix-cve
        - uuid: 10908cd0e892439ca213a830888c33ec
          name: 'Last Critical CVE Ticket Number'
          type: HTTP_AGENT
          key: Last-reported-Critical-CVE-Ticket
          delay: 30m
          trends: '0'
          value_type: TEXT
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/[\s\S]*?<tbody>([\s\S]*?)<div class=''dev-status-column-view-wrapper''>[\s\S]*/, "$1");'
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/[\s\S]*?data-issuekey="([\s\S]*?)" class="issuerow">[\s\S]*/, "$1");'
          timeout: 5s
          url: 'https://support.zabbix.com/sr/jira.issueviews:searchrequest-printable/temp/SearchRequest.html'
          query_fields:
            - name: jqlQuery
              value: 'issuetype = "Defect (Security)" AND priority = Critical ORDER BY UPDATED DESC'
            - name: tempMax
              value: '5'
          tags:
            - tag: type
              value: zabbix-cve
          triggers:
            - uuid: 7ee847c8aa6047d2a2945eb31e6ce087
              expression: '(last(/Zabbix CVE Watch/Last-reported-Critical-CVE-Ticket,#1)<>last(/Zabbix CVE Watch/Last-reported-Critical-CVE-Ticket,#2))=1'
              recovery_mode: NONE
              name: 'New Reported Critical CVE'
              event_name: 'New Reported Critical CVE'
              url: 'https://support.zabbix.com/sr/jira.issueviews:searchrequest-printable/temp/SearchRequest.html?jqlQuery=priority+%3D+Critical+ORDER+BY+cf[11111]+DESC&tempMax=5'
              priority: DISASTER
              description: 'Allert triggert when the last detected Critical CVE changes.'
              manual_close: 'YES'
        - uuid: 907961c26bd74cf09e901f31e9f11ea3
          name: 'Last Critical CVE Updated Date'
          type: HTTP_AGENT
          key: Last-reported-Critical-CVE-Update-Date
          delay: 30m
          trends: '0'
          value_type: TEXT
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/[\s\S]*?<tbody>([\s\S]*?)<div class=''dev-status-column-view-wrapper''>[\s\S]*/, "$1");'
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/[\s\S]*?class="updated"> <span title="([\s\S]*?)">[\s\S]*/, "$1");'
            - type: REGEX
              parameters:
                - '^(\d{4})\s(\w{3})\s(\d{2})\s(\d{2}):(\d{2})$'
                - \1-\2-\3
          timeout: 5s
          url: 'https://support.zabbix.com/sr/jira.issueviews:searchrequest-printable/temp/SearchRequest.html'
          query_fields:
            - name: jqlQuery
              value: 'issuetype = "Defect (Security)" AND priority = Critical ORDER BY UPDATED DESC'
            - name: tempMax
              value: '5'
          tags:
            - tag: type
              value: zabbix-cve
        - uuid: 520dd431fe124b4eb0f60a006ae50c1b
          name: 'Last Critical CVE URL'
          type: HTTP_AGENT
          key: Last-reported-Critical-CVE-URL
          delay: 30m
          trends: '0'
          value_type: TEXT
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/[\s\S]*?<tbody>([\s\S]*?)<div class=''dev-status-column-view-wrapper''>[\s\S]*/, "$1");'
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/[\s\S]*?class="summary"><p>([\s\S]*?)<\/a>[\s\S]*/, "$1");'
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/[\s\S]*?href="([\s\S]*?)">[\s\S]*/, "$1");'
          timeout: 5s
          url: 'https://support.zabbix.com/sr/jira.issueviews:searchrequest-printable/temp/SearchRequest.html'
          query_fields:
            - name: jqlQuery
              value: 'issuetype = "Defect (Security)" AND priority = Critical ORDER BY UPDATED DESC'
            - name: tempMax
              value: '5'
          tags:
            - tag: type
              value: zabbix-cve
        - uuid: f82c40625f1e4755a187f94bacbe3a0f
          name: 'Last High CVE Creation Date'
          type: HTTP_AGENT
          key: Last-reported-High-CVE-Creation-Date
          delay: 30m
          trends: '0'
          value_type: TEXT
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/[\s\S]*?<tbody>([\s\S]*?)<div class=''dev-status-column-view-wrapper''>[\s\S]*/, "$1");'
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/[\s\S]*?class="created"> <span title="([\s\S]*?)">[\s\S]*/, "$1");'
            - type: REGEX
              parameters:
                - '^(\d{4})\s(\w{3})\s(\d{2})\s(\d{2}):(\d{2})$'
                - \1-\2-\3
          timeout: 5s
          url: 'https://support.zabbix.com/sr/jira.issueviews:searchrequest-printable/temp/SearchRequest.html'
          query_fields:
            - name: jqlQuery
              value: 'priority = High ORDER BY CREATED DESC'
            - name: tempMax
              value: '5'
          tags:
            - tag: type
              value: zabbix-cve
        - uuid: 7b9d882a7b70416885d55c6901e76797
          name: 'Last High CVE Description'
          type: HTTP_AGENT
          key: Last-reported-High-CVE-Description
          delay: 30m
          trends: '0'
          value_type: TEXT
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/[\s\S]*?<tbody>([\s\S]*?)<div class=''dev-status-column-view-wrapper''>[\s\S]*/, "$1");'
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/[\s\S]*?class="summary"><p>([\s\S]*?)<td class="assignee">[\s\S]*/, "$1");'
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/.*?>([^<]*?)<\/a>.*/g, "$1");'
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/<a.*?>([^<]*?)<\/a>|<\/p>|<\/td>/g, "$1");'
          timeout: 5s
          url: 'https://support.zabbix.com/sr/jira.issueviews:searchrequest-printable/temp/SearchRequest.html'
          query_fields:
            - name: jqlQuery
              value: 'priority = High ORDER BY CREATED DESC'
            - name: tempMax
              value: '5'
          tags:
            - tag: type
              value: zabbix-cve
        - uuid: 834c6c1832094530911d1d04c59ffc53
          name: 'Last High CVE Name'
          type: HTTP_AGENT
          key: Last-reported-High-CVE-Name
          delay: 30m
          trends: '0'
          value_type: TEXT
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/[\s\S]*?<tbody>([\s\S]*?)<div class=''dev-status-column-view-wrapper''>[\s\S]*/, "$1");'
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/[\s\S]*?data-issuekey="([\s\S]*?)" class="issuerow">[\s\S]*/, "$1");'
          url: 'https://support.zabbix.com/sr/jira.issueviews:searchrequest-printable/temp/SearchRequest.html?jqlQuery=priority+%3D+High+ORDER+BY+CREATED+DESC&tempMax=5'
          tags:
            - tag: type
              value: zabbix-cve
          triggers:
            - uuid: 897790a8b7f84e4499c373f82bb9dd95
              expression: '(last(/Zabbix CVE Watch/Last-reported-High-CVE-Name,#1)<>last(/Zabbix CVE Watch/Last-reported-High-CVE-Name,#2))=1'
              recovery_mode: NONE
              name: 'New Reported High CVE'
              event_name: 'New Reported High CVE'
              url: 'https://support.zabbix.com/sr/jira.issueviews:searchrequest-printable/temp/SearchRequest.html?jqlQuery=priority+%3D+High+ORDER+BY+cf[11111]+DESC&tempMax=5'
              priority: HIGH
              description: 'Allert triggert when the last detected High CVE changes.'
              manual_close: 'YES'
        - uuid: 4bfc37d648be4c61a70bf73b5a94ca63
          name: 'Last High CVE Updated Date'
          type: HTTP_AGENT
          key: Last-reported-High-CVE-Updated-Date
          delay: 30m
          trends: '0'
          value_type: TEXT
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/[\s\S]*?<tbody>([\s\S]*?)<div class=''dev-status-column-view-wrapper''>[\s\S]*/, "$1");'
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/[\s\S]*?class="updated"> <span title="([\s\S]*?)">[\s\S]*/, "$1");'
            - type: REGEX
              parameters:
                - '^(\d{4})\s(\w{3})\s(\d{2})\s(\d{2}):(\d{2})$'
                - \1-\2-\3
          timeout: 5s
          url: 'https://support.zabbix.com/sr/jira.issueviews:searchrequest-printable/temp/SearchRequest.html'
          query_fields:
            - name: jqlQuery
              value: 'priority = High ORDER BY CREATED DESC'
            - name: tempMax
              value: '5'
          tags:
            - tag: type
              value: zabbix-cve
        - uuid: 0712097711b84a9ca2e8eb7916e5e133
          name: 'Last High CVE URL'
          type: HTTP_AGENT
          key: Last-reported-High-CVE-URL
          delay: 30m
          trends: '0'
          value_type: TEXT
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/[\s\S]*?<tbody>([\s\S]*?)<div class=''dev-status-column-view-wrapper''>[\s\S]*/, "$1");'
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/[\s\S]*?class="summary"><p>([\s\S]*?)<\/a>[\s\S]*/, "$1");'
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/[\s\S]*?href="([\s\S]*?)">[\s\S]*/, "$1");'
          timeout: 5s
          url: 'https://support.zabbix.com/sr/jira.issueviews:searchrequest-printable/temp/SearchRequest.html'
          query_fields:
            - name: jqlQuery
              value: 'priority = High ORDER BY CREATED DESC'
            - name: tempMax
              value: '5'
          tags:
            - tag: type
              value: zabbix-cve
        - uuid: dad441a8682d4dd8831988f87cf6ac16
          name: 'Last Major CVE Creation Date'
          type: HTTP_AGENT
          key: Last-reported-Major-CVE-Creation-Date
          delay: 30m
          trends: '0'
          value_type: TEXT
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/[\s\S]*?<tbody>([\s\S]*?)<div class=''dev-status-column-view-wrapper''>[\s\S]*/, "$1");'
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/[\s\S]*?class="created"> <span title="([\s\S]*?)">[\s\S]*/, "$1");'
            - type: REGEX
              parameters:
                - '^(\d{4})\s(\w{3})\s(\d{2})\s(\d{2}):(\d{2})$'
                - \1-\2-\3
          timeout: 5s
          url: 'https://support.zabbix.com/sr/jira.issueviews:searchrequest-printable/temp/SearchRequest.html'
          query_fields:
            - name: jqlQuery
              value: 'priority = Major ORDER BY UPDATED DESC'
            - name: tempMax
              value: '5'
          tags:
            - tag: type
              value: zabbix-cve
        - uuid: 92b1cae6436c4d139c15049dad338c18
          name: 'Last Major CVE Description'
          type: HTTP_AGENT
          key: Last-reported-Major-CVE-Description
          delay: 30m
          trends: '0'
          value_type: TEXT
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/[\s\S]*?<tbody>([\s\S]*?)<div class=''dev-status-column-view-wrapper''>[\s\S]*/, "$1");'
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/[\s\S]*?class="summary"><p>([\s\S]*?)<td class="assignee">[\s\S]*/, "$1");'
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/.*?>([^<]*?)<\/a>.*/g, "$1");'
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/<a.*?>([^<]*?)<\/a>|<\/p>|<\/td>/g, "$1");'
          timeout: 5s
          url: 'https://support.zabbix.com/sr/jira.issueviews:searchrequest-printable/temp/SearchRequest.html'
          query_fields:
            - name: jqlQuery
              value: 'priority = Major ORDER BY UPDATED DESC'
            - name: tempMax
              value: '5'
          tags:
            - tag: type
              value: zabbix-cve
        - uuid: 8aabbbc9f9ea4c9aa9fd6c442108e5f0
          name: 'Last Major CVE Name'
          type: HTTP_AGENT
          key: Last-reported-Major-CVE-Name
          delay: 30m
          trends: '0'
          value_type: TEXT
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/[\s\S]*?<tbody>([\s\S]*?)<div class=''dev-status-column-view-wrapper''>[\s\S]*/, "$1");'
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/[\s\S]*?data-issuekey="([\s\S]*?)" class="issuerow">[\s\S]*/, "$1");'
          url: 'https://support.zabbix.com/sr/jira.issueviews:searchrequest-printable/temp/SearchRequest.html?jqlQuery=priority+%3D+Major+ORDER+BY+UPDATED+DESC&tempMax=5'
          tags:
            - tag: type
              value: zabbix-cve
          triggers:
            - uuid: a132cdd6cdf14f2db81f0290f30c3307
              expression: '(last(/Zabbix CVE Watch/Last-reported-Major-CVE-Name,#1)<>last(/Zabbix CVE Watch/Last-reported-Major-CVE-Name,#2))=1'
              recovery_mode: NONE
              name: 'New Reported Major CVE'
              event_name: 'New Reported Major CVE'
              url: 'https://support.zabbix.com/sr/jira.issueviews:searchrequest-printable/temp/SearchRequest.html?jqlQuery=priority+%3D+Major+ORDER+BY+cf[11111]+DESC&tempMax=5'
              priority: HIGH
              description: 'Allert triggert when the last detected Major CVE changes.'
              manual_close: 'YES'
        - uuid: 377a543f9fae46cbba3ea8155bd6e7ec
          name: 'Last Major CVE Updated Date'
          type: HTTP_AGENT
          key: Last-reported-Major-CVE-Updated-Date
          delay: 30m
          trends: '0'
          value_type: TEXT
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/[\s\S]*?<tbody>([\s\S]*?)<div class=''dev-status-column-view-wrapper''>[\s\S]*/, "$1");'
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/[\s\S]*?class="updated"> <span title="([\s\S]*?)">[\s\S]*/, "$1");'
            - type: REGEX
              parameters:
                - '^(\d{4})\s(\w{3})\s(\d{2})\s(\d{2}):(\d{2})$'
                - \1-\2-\3
          timeout: 5s
          url: 'https://support.zabbix.com/sr/jira.issueviews:searchrequest-printable/temp/SearchRequest.html'
          query_fields:
            - name: jqlQuery
              value: 'priority = Major ORDER BY UPDATED DESC'
            - name: tempMax
              value: '5'
          tags:
            - tag: type
              value: zabbix-cve
        - uuid: d5254fdf657148ffa470c933cc7082b2
          name: 'Last Major CVE URL'
          type: HTTP_AGENT
          key: Last-reported-Major-CVE-URL
          delay: 30m
          trends: '0'
          value_type: TEXT
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/[\s\S]*?<tbody>([\s\S]*?)<div class=''dev-status-column-view-wrapper''>[\s\S]*/, "$1");'
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/[\s\S]*?class="summary"><p>([\s\S]*?)<\/a>[\s\S]*/, "$1");'
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/[\s\S]*?href="([\s\S]*?)">[\s\S]*/, "$1");'
          timeout: 5s
          url: 'https://support.zabbix.com/sr/jira.issueviews:searchrequest-printable/temp/SearchRequest.html'
          query_fields:
            - name: jqlQuery
              value: 'priority = Major ORDER BY UPDATED DESC'
            - name: tempMax
              value: '5'
          tags:
            - tag: type
              value: zabbix-cve
        - uuid: c14648d4ddb04c8f90cccecf1622c513
          name: 'Last Medium CVE Creation Date'
          type: HTTP_AGENT
          key: Last-reported-Medium-CVE-Creation-Date
          delay: 30m
          trends: '0'
          value_type: TEXT
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/[\s\S]*?<tbody>([\s\S]*?)<div class=''dev-status-column-view-wrapper''>[\s\S]*/, "$1");'
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/[\s\S]*?class="created"> <span title="([\s\S]*?)">[\s\S]*/, "$1");'
            - type: REGEX
              parameters:
                - '^(\d{4})\s(\w{3})\s(\d{2})\s(\d{2}):(\d{2})$'
                - \1-\2-\3
          timeout: 5s
          url: 'https://support.zabbix.com/sr/jira.issueviews:searchrequest-printable/temp/SearchRequest.html'
          query_fields:
            - name: jqlQuery
              value: 'priority = Medium ORDER BY UPDATED DESC'
            - name: tempMax
              value: '5'
          tags:
            - tag: type
              value: zabbix-cve
        - uuid: d7503e42487345628009662b26f71bc7
          name: 'Last Medium CVE Description'
          type: HTTP_AGENT
          key: Last-reported-Medium-CVE-Description
          delay: 30m
          trends: '0'
          value_type: TEXT
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/[\s\S]*?<tbody>([\s\S]*?)<div class=''dev-status-column-view-wrapper''>[\s\S]*/, "$1");'
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/[\s\S]*?class="summary"><p>([\s\S]*?)<td class="assignee">[\s\S]*/, "$1");'
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/.*?>([^<]*?)<\/a>.*/g, "$1");'
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/<a.*?>([^<]*?)<\/a>|<\/p>|<\/td>/g, "$1");'
          timeout: 5s
          url: 'https://support.zabbix.com/sr/jira.issueviews:searchrequest-printable/temp/SearchRequest.html'
          query_fields:
            - name: jqlQuery
              value: 'priority = Medium ORDER BY UPDATED DESC'
            - name: tempMax
              value: '5'
          tags:
            - tag: type
              value: zabbix-cve
        - uuid: 54354372cc494a5d8ddae60c1a0a7395
          name: 'Last Medium CVE Name'
          type: HTTP_AGENT
          key: Last-reported-Medium-CVE-Name
          delay: 30m
          trends: '0'
          value_type: TEXT
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/[\s\S]*?<tbody>([\s\S]*?)<div class=''dev-status-column-view-wrapper''>[\s\S]*/, "$1");'
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/[\s\S]*?data-issuekey="([\s\S]*?)" class="issuerow">[\s\S]*/, "$1");'
          url: 'https://support.zabbix.com/sr/jira.issueviews:searchrequest-printable/temp/SearchRequest.html'
          query_fields:
            - name: jqlQuery
              value: 'priority = Medium ORDER BY UPDATED DESC'
            - name: tempMax
              value: '5'
          tags:
            - tag: type
              value: zabbix-cve
          triggers:
            - uuid: 80316efdee0245f685fdcc254a3f9447
              expression: '(last(/Zabbix CVE Watch/Last-reported-Medium-CVE-Name,#1)<>last(/Zabbix CVE Watch/Last-reported-Medium-CVE-Name,#2))=1'
              recovery_mode: NONE
              name: 'New Reported Medium CVE'
              event_name: 'New Reported Medium CVE'
              url: 'https://support.zabbix.com/sr/jira.issueviews:searchrequest-printable/temp/SearchRequest.html?jqlQuery=priority+%3D+Medium+ORDER+BY+cf[11111]+DESC&tempMax=5'
              priority: AVERAGE
              description: 'Allert triggert when the last detected Medium CVE changes.'
              manual_close: 'YES'
        - uuid: 33192fe1733c4292a712f86c1728e833
          name: 'Last Medium CVE Updated Date'
          type: HTTP_AGENT
          key: Last-reported-Medium-CVE-Updated-Date
          delay: 30m
          trends: '0'
          value_type: TEXT
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/[\s\S]*?<tbody>([\s\S]*?)<div class=''dev-status-column-view-wrapper''>[\s\S]*/, "$1");'
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/[\s\S]*?class="updated"> <span title="([\s\S]*?)">[\s\S]*/, "$1");'
            - type: REGEX
              parameters:
                - '^(\d{4})\s(\w{3})\s(\d{2})\s(\d{2}):(\d{2})$'
                - \1-\2-\3
          timeout: 5s
          url: 'https://support.zabbix.com/sr/jira.issueviews:searchrequest-printable/temp/SearchRequest.html'
          query_fields:
            - name: jqlQuery
              value: 'priority = Medium ORDER BY UPDATED DESC'
            - name: tempMax
              value: '5'
          tags:
            - tag: type
              value: zabbix-cve
        - uuid: 881dabc015ea40b288a1facd9cd81131
          name: 'Last Medium CVE URL'
          type: HTTP_AGENT
          key: Last-reported-Medium-CVE-URL
          delay: 30m
          trends: '0'
          value_type: TEXT
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/[\s\S]*?<tbody>([\s\S]*?)<div class=''dev-status-column-view-wrapper''>[\s\S]*/, "$1");'
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/[\s\S]*?class="summary"><p>([\s\S]*?)<\/a>[\s\S]*/, "$1");'
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/[\s\S]*?href="([\s\S]*?)">[\s\S]*/, "$1");'
          timeout: 5s
          url: 'https://support.zabbix.com/sr/jira.issueviews:searchrequest-printable/temp/SearchRequest.html'
          query_fields:
            - name: jqlQuery
              value: 'priority = Medium ORDER BY UPDATED DESC'
            - name: tempMax
              value: '5'
          tags:
            - tag: type
              value: zabbix-cve
        - uuid: 378164f6fd8a42b08d75a17bbbafaeeb
          name: 'Last Minor CVE Creation Date'
          type: HTTP_AGENT
          key: Last-reported-Minor-CVE-Creation-Date
          delay: 30m
          trends: '0'
          value_type: TEXT
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/[\s\S]*?<tbody>([\s\S]*?)<div class=''dev-status-column-view-wrapper''>[\s\S]*/, "$1");'
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/[\s\S]*?class="created"> <span title="([\s\S]*?)">[\s\S]*/, "$1");'
            - type: REGEX
              parameters:
                - '^(\d{4})\s(\w{3})\s(\d{2})\s(\d{2}):(\d{2})$'
                - \1-\2-\3
          timeout: 5s
          url: 'https://support.zabbix.com/sr/jira.issueviews:searchrequest-printable/temp/SearchRequest.html'
          query_fields:
            - name: jqlQuery
              value: 'priority = Minor ORDER BY UPDATED DESC'
            - name: tempMax
              value: '5'
          tags:
            - tag: type
              value: zabbix-cve
        - uuid: b4987066af27442595b068ba2bf3b965
          name: 'Last Minor CVE Description'
          type: HTTP_AGENT
          key: Last-reported-Minor-CVE-Description
          delay: 30m
          trends: '0'
          value_type: TEXT
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/[\s\S]*?<tbody>([\s\S]*?)<div class=''dev-status-column-view-wrapper''>[\s\S]*/, "$1");'
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/[\s\S]*?class="summary"><p>([\s\S]*?)<td class="assignee">[\s\S]*/, "$1");'
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/.*?>([^<]*?)<\/a>.*/g, "$1");'
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/<a.*?>([^<]*?)<\/a>|<\/p>|<\/td>/g, "$1");'
          timeout: 5s
          url: 'https://support.zabbix.com/sr/jira.issueviews:searchrequest-printable/temp/SearchRequest.html'
          query_fields:
            - name: jqlQuery
              value: 'priority = Minor ORDER BY UPDATED DESC'
            - name: tempMax
              value: '5'
          tags:
            - tag: type
              value: zabbix-cve
        - uuid: 28b67df0d1eb4ea39a41f804fbe3d4dc
          name: 'Last Minor CVE Name'
          type: HTTP_AGENT
          key: Last-reported-Minor-CVE-Name
          delay: 30m
          trends: '0'
          value_type: TEXT
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/[\s\S]*?<tbody>([\s\S]*?)<div class=''dev-status-column-view-wrapper''>[\s\S]*/, "$1");'
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/[\s\S]*?data-issuekey="([\s\S]*?)" class="issuerow">[\s\S]*/, "$1");'
          url: 'https://support.zabbix.com/sr/jira.issueviews:searchrequest-printable/temp/SearchRequest.html'
          query_fields:
            - name: jqlQuery
              value: 'priority = Minor ORDER BY UPDATED DESC'
            - name: tempMax
              value: '5'
          tags:
            - tag: type
              value: zabbix-cve
          triggers:
            - uuid: 466536db43124c5291865353f313b398
              expression: '(last(/Zabbix CVE Watch/Last-reported-Minor-CVE-Name,#1)<>last(/Zabbix CVE Watch/Last-reported-Minor-CVE-Name,#2))=1'
              recovery_mode: NONE
              name: 'New Reported Minor CVE'
              event_name: 'New Reported Minor CVE'
              url: 'https://support.zabbix.com/sr/jira.issueviews:searchrequest-printable/temp/SearchRequest.html?jqlQuery=priority+%3D+Minor+ORDER+BY+cf[11111]+DESC&tempMax=5'
              priority: WARNING
              description: 'Allert triggert when the last detected Minor CVE changes.'
              manual_close: 'YES'
        - uuid: 26d00dd3e1034c4f8bf9be00ec80060c
          name: 'Last Minor CVE Updated Date'
          type: HTTP_AGENT
          key: Last-reported-Minor-CVE-Updated-Date
          delay: 30m
          trends: '0'
          value_type: TEXT
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/[\s\S]*?<tbody>([\s\S]*?)<div class=''dev-status-column-view-wrapper''>[\s\S]*/, "$1");'
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/[\s\S]*?class="updated"> <span title="([\s\S]*?)">[\s\S]*/, "$1");'
            - type: REGEX
              parameters:
                - '^(\d{4})\s(\w{3})\s(\d{2})\s(\d{2}):(\d{2})$'
                - \1-\2-\3
          timeout: 5s
          url: 'https://support.zabbix.com/sr/jira.issueviews:searchrequest-printable/temp/SearchRequest.html'
          query_fields:
            - name: jqlQuery
              value: 'priority = Minor ORDER BY UPDATED DESC'
            - name: tempMax
              value: '5'
          tags:
            - tag: type
              value: zabbix-cve
        - uuid: a601924e00174e1bb48ae538a9418023
          name: 'Last Minor CVE URL'
          type: HTTP_AGENT
          key: Last-reported-Minor-CVE-URL
          delay: 30m
          trends: '0'
          value_type: TEXT
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/[\s\S]*?<tbody>([\s\S]*?)<div class=''dev-status-column-view-wrapper''>[\s\S]*/, "$1");'
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/[\s\S]*?class="summary"><p>([\s\S]*?)<\/a>[\s\S]*/, "$1");'
            - type: JAVASCRIPT
              parameters:
                - 'return value.replace(/[\s\S]*?href="([\s\S]*?)">[\s\S]*/, "$1");'
          timeout: 5s
          url: 'https://support.zabbix.com/sr/jira.issueviews:searchrequest-printable/temp/SearchRequest.html'
          query_fields:
            - name: jqlQuery
              value: 'priority = Minor ORDER BY UPDATED DESC'
            - name: tempMax
              value: '5'
          tags:
            - tag: type
              value: zabbix-cve
      dashboards:
        - uuid: c0f60bd0f4914527804b5b8814c67f97
          name: 'CVE Watch'
          auto_start: 'NO'
          pages:
            - widgets:
                - type: plaintext
                  name: 'Last Critical CVE'
                  width: '12'
                  height: '6'
                  fields:
                    - type: ITEM
                      name: itemids
                      value:
                        host: 'Zabbix CVE Watch'
                        key: Last-reported-Critical-CVE-Affected-Version
                    - type: ITEM
                      name: itemids
                      value:
                        host: 'Zabbix CVE Watch'
                        key: Last-reported-Critical-CVE-Creation-Date
                    - type: ITEM
                      name: itemids
                      value:
                        host: 'Zabbix CVE Watch'
                        key: Last-reported-Critical-CVE-Description
                    - type: ITEM
                      name: itemids
                      value:
                        host: 'Zabbix CVE Watch'
                        key: Last-reported-Critical-CVE-Fixed-Version
                    - type: ITEM
                      name: itemids
                      value:
                        host: 'Zabbix CVE Watch'
                        key: Last-reported-Critical-CVE-ID-Number
                    - type: ITEM
                      name: itemids
                      value:
                        host: 'Zabbix CVE Watch'
                        key: Last-reported-Critical-CVE-Resolution
                    - type: ITEM
                      name: itemids
                      value:
                        host: 'Zabbix CVE Watch'
                        key: Last-reported-Critical-CVE-Status
                    - type: ITEM
                      name: itemids
                      value:
                        host: 'Zabbix CVE Watch'
                        key: Last-reported-Critical-CVE-Ticket
                    - type: ITEM
                      name: itemids
                      value:
                        host: 'Zabbix CVE Watch'
                        key: Last-reported-Critical-CVE-Update-Date
                    - type: ITEM
                      name: itemids
                      value:
                        host: 'Zabbix CVE Watch'
                        key: Last-reported-Critical-CVE-URL
                    - type: INTEGER
                      name: show_as_html
                      value: '1'
                    - type: INTEGER
                      name: show_lines
                      value: '10'
                - type: plaintext
                  name: 'Last High CVE'
                  'y': '6'
                  width: '12'
                  height: '4'
                  fields:
                    - type: ITEM
                      name: itemids
                      value:
                        host: 'Zabbix CVE Watch'
                        key: Last-reported-High-CVE-Creation-Date
                    - type: ITEM
                      name: itemids
                      value:
                        host: 'Zabbix CVE Watch'
                        key: Last-reported-High-CVE-Description
                    - type: ITEM
                      name: itemids
                      value:
                        host: 'Zabbix CVE Watch'
                        key: Last-reported-High-CVE-Name
                    - type: ITEM
                      name: itemids
                      value:
                        host: 'Zabbix CVE Watch'
                        key: Last-reported-High-CVE-Updated-Date
                    - type: ITEM
                      name: itemids
                      value:
                        host: 'Zabbix CVE Watch'
                        key: Last-reported-High-CVE-URL
                    - type: INTEGER
                      name: show_as_html
                      value: '1'
                    - type: INTEGER
                      name: show_lines
                      value: '5'
                - type: plaintext
                  name: 'Last Major CVE'
                  'y': '10'
                  width: '12'
                  height: '4'
                  fields:
                    - type: ITEM
                      name: itemids
                      value:
                        host: 'Zabbix CVE Watch'
                        key: Last-reported-Major-CVE-Creation-Date
                    - type: ITEM
                      name: itemids
                      value:
                        host: 'Zabbix CVE Watch'
                        key: Last-reported-Major-CVE-Description
                    - type: ITEM
                      name: itemids
                      value:
                        host: 'Zabbix CVE Watch'
                        key: Last-reported-Major-CVE-Name
                    - type: ITEM
                      name: itemids
                      value:
                        host: 'Zabbix CVE Watch'
                        key: Last-reported-Major-CVE-Updated-Date
                    - type: ITEM
                      name: itemids
                      value:
                        host: 'Zabbix CVE Watch'
                        key: Last-reported-Major-CVE-URL
                    - type: INTEGER
                      name: show_as_html
                      value: '1'
                    - type: INTEGER
                      name: show_lines
                      value: '5'
                - type: clock
                  x: '12'
                  width: '9'
                  height: '3'
                  fields:
                    - type: INTEGER
                      name: adv_conf
                      value: '1'
                    - type: INTEGER
                      name: clock_type
                      value: '1'
                    - type: INTEGER
                      name: date_bold
                      value: '1'
                    - type: INTEGER
                      name: date_size
                      value: '60'
                    - type: INTEGER
                      name: show
                      value: '1'
                    - type: INTEGER
                      name: show
                      value: '3'
                - type: plaintext
                  name: 'Last Medium CVE'
                  x: '12'
                  'y': '3'
                  width: '12'
                  height: '4'
                  fields:
                    - type: ITEM
                      name: itemids
                      value:
                        host: 'Zabbix CVE Watch'
                        key: Last-reported-Medium-CVE-Creation-Date
                    - type: ITEM
                      name: itemids
                      value:
                        host: 'Zabbix CVE Watch'
                        key: Last-reported-Medium-CVE-Description
                    - type: ITEM
                      name: itemids
                      value:
                        host: 'Zabbix CVE Watch'
                        key: Last-reported-Medium-CVE-Name
                    - type: ITEM
                      name: itemids
                      value:
                        host: 'Zabbix CVE Watch'
                        key: Last-reported-Medium-CVE-Updated-Date
                    - type: ITEM
                      name: itemids
                      value:
                        host: 'Zabbix CVE Watch'
                        key: Last-reported-Medium-CVE-URL
                    - type: INTEGER
                      name: show_as_html
                      value: '1'
                    - type: INTEGER
                      name: show_lines
                      value: '5'
                - type: plaintext
                  name: 'Last Minor CVE'
                  x: '12'
                  'y': '7'
                  width: '12'
                  height: '4'
                  fields:
                    - type: ITEM
                      name: itemids
                      value:
                        host: 'Zabbix CVE Watch'
                        key: Last-reported-Minor-CVE-Creation-Date
                    - type: ITEM
                      name: itemids
                      value:
                        host: 'Zabbix CVE Watch'
                        key: Last-reported-Minor-CVE-Description
                    - type: ITEM
                      name: itemids
                      value:
                        host: 'Zabbix CVE Watch'
                        key: Last-reported-Minor-CVE-Name
                    - type: ITEM
                      name: itemids
                      value:
                        host: 'Zabbix CVE Watch'
                        key: Last-reported-Minor-CVE-Updated-Date
                    - type: ITEM
                      name: itemids
                      value:
                        host: 'Zabbix CVE Watch'
                        key: Last-reported-Minor-CVE-URL
                    - type: INTEGER
                      name: show_as_html
                      value: '1'
                    - type: INTEGER
                      name: show_lines
                      value: '5'
                - type: clock
                  x: '21'
                  width: '3'
                  height: '3'
